<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ESP32-P4 Web Flasher</title>
    <style>
      :root {
        color-scheme: dark;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        font-family: Inter, "Segoe UI", Tahoma, Arial, sans-serif;
        color: #eef2ff;
        background: radial-gradient(circle at top right, #1f2b5f 0%, #0a1026 45%, #060913 100%);
      }

      .page {
        width: min(1120px, 100% - 32px);
        margin: 24px auto 36px;
      }

      .header {
        display: flex;
        justify-content: space-between;
        gap: 16px;
        margin-bottom: 18px;
      }

      h1 {
        margin: 0;
        font-size: 30px;
        line-height: 1.2;
      }

      .subtitle {
        margin-top: 8px;
        color: #c5d1ff;
        font-size: 14px;
      }

      .support {
        border-radius: 999px;
        border: 1px solid #2f447f;
        background: #111b3f;
        color: #b6c5ff;
        padding: 8px 14px;
        font-size: 12px;
        white-space: nowrap;
      }

      .layout {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
      }

      .card {
        background: linear-gradient(160deg, #121a39, #0b1230 75%);
        border: 1px solid #243467;
        border-radius: 14px;
        padding: 18px;
        box-shadow: 0 14px 30px rgba(3, 8, 24, 0.45);
      }

      .card h2 {
        margin: 0;
        font-size: 19px;
      }

      .card-head {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        margin-bottom: 14px;
      }

      .status-pill {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        border-radius: 999px;
        font-size: 12px;
        padding: 5px 10px;
        border: 1px solid #2b3f76;
        background: #111d46;
        color: #aabcf9;
      }

      .status-pill.active {
        border-color: #1c8e65;
        background: #0d2f28;
        color: #82e3c2;
      }

      .field-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 12px;
      }

      .field {
        display: grid;
        gap: 6px;
      }

      label {
        font-size: 12px;
        color: #a8b8f2;
        font-weight: 600;
        letter-spacing: 0.02em;
      }

      input[type="text"],
      input[type="file"],
      select,
      textarea {
        width: 100%;
        border-radius: 10px;
        border: 1px solid #2c3f77;
        background: #080f29;
        color: #e7ecff;
        padding: 10px 12px;
        outline: none;
      }

      input::file-selector-button {
        border: none;
        border-radius: 7px;
        margin-right: 10px;
        padding: 6px 10px;
        background: #1e2f69;
        color: #e7ecff;
        cursor: pointer;
      }

      .action-row {
        margin-top: 6px;
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      button {
        border: 1px solid #314685;
        border-radius: 10px;
        background: #1b2b61;
        color: #eef2ff;
        padding: 10px 14px;
        font-weight: 600;
        cursor: pointer;
      }

      button.primary {
        background: linear-gradient(180deg, #3d67ff, #3257d5);
        border-color: #5677f2;
      }

      button.warn {
        background: #4f2234;
        border-color: #764058;
      }

      button:disabled {
        opacity: 0.45;
        cursor: not-allowed;
      }

      textarea {
        min-height: 220px;
        resize: vertical;
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
        font-size: 12px;
        line-height: 1.45;
      }

      .monitor-tools {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 10px;
        gap: 8px;
      }

      .toggle {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        font-size: 12px;
        color: #aabcf9;
      }

      .monitor-send {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 10px;
        margin-top: 10px;
      }

      .footer-note {
        margin-top: 14px;
        color: #9db0ef;
        font-size: 12px;
      }

      @media (max-width: 900px) {
        .layout {
          grid-template-columns: 1fr;
        }

        .support {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <main class="page">
      <div class="header">
        <div>
          <h1>ESP32-P4 Web Loader</h1>
          <div class="subtitle">Flash firmware and monitor serial logs from one browser dashboard.</div>
        </div>
        <div class="support">Chrome / Edge Â· HTTPS or localhost</div>
      </div>

      <div class="layout">
        <section class="card">
          <div class="card-head">
            <h2>Firmware Flasher</h2>
            <span id="flashStatus" class="status-pill">Disconnected</span>
          </div>

          <div class="field-grid">
            <div class="field">
              <label for="binSelect">BIN file from this folder</label>
              <select id="binSelect">
                <option value="ESP32-P4_Function_EV_Board.bin">ESP32-P4_Function_EV_Board.bin</option>
                <option value="JC1060WP470C_I_W_Y.bin">JC1060WP470C_I_W_Y.bin</option>
              </select>
            </div>

            <div class="field">
              <label for="binFile">Or browse local BIN</label>
              <input id="binFile" type="file" accept=".bin" />
            </div>

            <div class="field">
              <label for="flashOffset">Flash offset</label>
              <input id="flashOffset" type="text" value="0x0" />
            </div>

            <div class="field">
              <label for="baudRate">Flash baud rate</label>
              <select id="baudRate">
                <option value="115200">115200</option>
                <option value="460800">460800</option>
                <option value="921600" selected>921600</option>
                <option value="1500000">1500000</option>
              </select>
            </div>
          </div>

          <div class="action-row">
            <button id="connectBtn" class="primary">Connect</button>
            <button id="flashBtn" class="primary" disabled>Flash</button>
            <button id="disconnectBtn" disabled>Disconnect</button>
          </div>

          <div class="field" style="margin-top: 10px">
            <label for="log">Flasher log</label>
            <textarea id="log" readonly></textarea>
          </div>
        </section>

        <section class="card">
          <div class="card-head">
            <h2>Serial Monitor</h2>
            <span id="monitorStatus" class="status-pill">Stopped</span>
          </div>

          <div class="field-grid">
            <div class="field">
              <label for="monitorBaud">Monitor baud rate</label>
              <select id="monitorBaud">
                <option value="9600">9600</option>
                <option value="115200" selected>115200</option>
                <option value="230400">230400</option>
                <option value="460800">460800</option>
                <option value="921600">921600</option>
              </select>
            </div>
          </div>

          <div class="action-row">
            <button id="monitorConnectBtn" class="primary">Start Monitor</button>
            <button id="monitorDisconnectBtn" disabled>Stop Monitor</button>
          </div>

          <div class="monitor-tools">
            <label class="toggle"><input id="monitorAutoScroll" type="checkbox" checked /> Auto-scroll</label>
            <button id="monitorClearBtn" class="warn">Clear</button>
          </div>

          <textarea id="monitorOutput" readonly></textarea>

          <div class="monitor-send">
            <input id="monitorInput" type="text" placeholder="Type command and press Send" />
            <button id="monitorSendBtn">Send</button>
          </div>
        </section>
      </div>

      <div class="footer-note">
        Tip: keep flasher and monitor disconnected from each other. Only one tool can use the serial port at a time.
      </div>
    </main>

    <script type="module" src="./app.js"></script>
  </body>
</html>
